# 환경 제어

난방기, 환기팬, 스크린, CO₂ 공급 등 환경 제어 장치에 대해 설명합니다.

## 개요

환경 제어는 온실 내 온도, 습도, CO₂, 조도 등을 최적 상태로 유지하기 위해 난방기, 환기팬, 스크린, CO₂ 공급 장치 등을 제어하는 시스템입니다.

## 제어 대상 장치

### 1. 난방기

#### 난방기 타입
- **보일러**: 온수 보일러 기반 난방
- **히터**: 전기 히터
- **히트펌프**: 히트펌프 기반 난방

#### 제어 방식
- **ON/OFF 제어**: 난방기 켜기/끄기
- **PWM 제어**: 펄스 폭 변조를 통한 출력 조절
- **온도 설정**: 목표 온도 설정

#### 제어 로직
- **온도 기준**: 현재 온도가 목표 온도보다 낮으면 ON
- **히스테리시스**: 켜기/끄기 온도 차이 설정 (과도한 ON/OFF 방지)
- **시간대별 설정**: 시간대별 목표 온도 설정

### 2. 환기팬

#### 환기팬 타입
- **측면 환기팬**: 온실 측면에 설치된 환기팬
- **천창 환기팬**: 온실 천장에 설치된 환기팬
- **순환 팬**: 공기 순환용 팬

#### 제어 방식
- **ON/OFF 제어**: 환기팬 켜기/끄기
- **속도 제어**: 팬 속도 조절 (3단, 5단 등)
- **PWM 제어**: 펄스 폭 변조를 통한 속도 조절

#### 제어 로직
- **온도 기준**: 현재 온도가 목표 온도보다 높으면 ON
- **습도 기준**: 습도가 높으면 ON
- **CO₂ 기준**: CO₂ 농도가 높으면 ON
- **시간대별 설정**: 시간대별 환기 설정

### 3. 스크린

#### 스크린 타입
- **차광 스크린**: 햇빛 차단용 스크린
- **보온 스크린**: 보온용 스크린
- **복합 스크린**: 차광 + 보온 기능

#### 제어 방식
- **개폐 제어**: 스크린 열기/닫기
- **부분 개폐**: 부분적으로 열기/닫기 (0~100%)
- **자동 개폐**: 자동으로 열기/닫기

#### 제어 로직
- **조도 기준**: 일사량이 높으면 차광 스크린 닫기
- **온도 기준**: 온도가 낮으면 보온 스크린 닫기
- **시간대별 설정**: 시간대별 스크린 설정

### 4. CO₂ 공급

#### CO₂ 공급 장치
- **CO₂ 발생기**: CO₂ 발생 장치
- **CO₂ 탱크**: 액화 CO₂ 탱크
- **배관 시스템**: CO₂ 배관 시스템

#### 제어 방식
- **ON/OFF 제어**: CO₂ 공급 켜기/끄기
- **유량 제어**: CO₂ 유량 조절
- **농도 기준**: 목표 CO₂ 농도 설정

#### 제어 로직
- **CO₂ 농도 기준**: 현재 CO₂ 농도가 목표보다 낮으면 공급
- **광합성 조건**: 일사량이 충분할 때만 공급
- **환기 고려**: 환기 시 CO₂ 공급 중단

### 5. 가습기/제습기

#### 가습 장치
- **가습기**: 공기 중 수증기 공급
- **분무 시스템**: 미세 분무 시스템

#### 제습 장치
- **제습기**: 공기 중 수증기 제거
- **환기**: 환기를 통한 제습

#### 제어 로직
- **습도 기준**: 습도가 목표보다 낮으면 가습, 높으면 제습
- **온도 고려**: 온도에 따른 최적 습도 범위 고려

### 6. 인공광

#### 인공광 타입
- **LED 조명**: LED 기반 인공광
- **HPS 조명**: 고압 나트륨 램프
- **멀티스펙트럼**: 다양한 파장 조합

#### 제어 방식
- **ON/OFF 제어**: 조명 켜기/끄기
- **밝기 제어**: 조명 밝기 조절 (0~100%)
- **스펙트럼 제어**: 파장 조합 조절

#### 제어 로직
- **일사량 기준**: 자연광이 부족하면 인공광 보조
- **일장 조절**: 작물별 필요 일장에 맞춰 조절
- **시간대별 설정**: 시간대별 인공광 설정

## 제어 전략

### 1. 온도 제어

#### 난방 제어
- **목표 온도**: 작물별 최적 온도 설정
- **히스테리시스**: ±1~2℃ 히스테리시스 설정
- **시간대별 온도**: 주간/야간 온도 차이 설정

#### 냉방 제어
- **환기**: 환기팬을 통한 냉방
- **차광**: 스크린을 통한 일사량 차단
- **분무**: 분무를 통한 증발 냉각

### 2. 습도 제어

#### 가습 제어
- **목표 습도**: 작물별 최적 습도 설정
- **증발산 고려**: 작물 증발산량 고려
- **온도 연동**: 온도에 따른 최적 습도 범위

#### 제습 제어
- **환기**: 환기를 통한 제습
- **가열**: 가열을 통한 상대습도 감소
- **제습기**: 제습기를 통한 제습

### 3. CO₂ 제어

#### CO₂ 공급
- **목표 농도**: 작물별 최적 CO₂ 농도 (800~1200ppm)
- **광합성 조건**: 일사량이 충분할 때만 공급
- **환기 고려**: 환기 시 공급 중단

### 4. 조도 제어

#### 자연광 활용
- **스크린 제어**: 차광 스크린으로 일사량 조절
- **최대 활용**: 자연광 최대한 활용

#### 인공광 보조
- **일사량 부족 시**: 자연광이 부족하면 인공광 보조
- **일장 조절**: 작물별 필요 일장에 맞춰 조절

## 통합 제어

### 1. 다중 장치 협조

#### 온도 + 습도
- **상호 영향 고려**: 온도와 습도의 상호 영향 고려
- **균형 제어**: 온도와 습도 균형 유지

#### CO₂ + 환기
- **환기 시 CO₂ 손실**: 환기 시 CO₂ 공급 중단
- **최적 타이밍**: 환기와 CO₂ 공급 최적 타이밍

### 2. 우선순위 관리

#### 제어 우선순위
- **안전 우선**: 안전 관련 제어 최우선
- **작물 건강**: 작물 건강 관련 제어 우선
- **에너지 효율**: 에너지 효율 고려

### 3. 충돌 방지

#### 제어 충돌
- **상호 배제**: 상호 배제되는 제어 방지
- **우선순위 적용**: 우선순위에 따른 제어 선택
- **사용자 확인**: 충돌 시 사용자 확인

## 모니터링 및 알람

### 1. 상태 모니터링
- **장치 상태**: 각 장치의 ON/OFF 상태
- **제어 값**: 현재 제어 값 (온도, 습도 등)
- **에너지 소비**: 각 장치의 에너지 소비

### 2. 알람
- **장치 오류**: 장치 오류 시 알람
- **목표 달성 실패**: 목표 값 달성 실패 시 알람
- **에너지 과다 소비**: 에너지 과다 소비 시 알람

## 관련 문서

- [온실 자동화](./greenhouse-automation.mdx)
- [Rule Builder](./rule-builder.mdx)
- [액추에이터 제어](./actuator-control.mdx)

