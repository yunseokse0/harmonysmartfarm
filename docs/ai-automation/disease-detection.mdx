# 병충해 탐지

YOLO 기반 객체 탐지와 Segmentation을 활용한 작물 병충해 자동 탐지 시스템에 대해 설명합니다.

## 개요

병충해 탐지는 컴퓨터 비전과 딥러닝을 활용하여 작물의 병해, 충해, 생리장해를 자동으로 탐지하고 분류하는 시스템입니다.

## 탐지 대상

### 병해 (Disease)
- **곰팡이병**: 흰가루병, 잎곰팡이병, 뿌리썩음병 등
- **세균병**: 세균성 점무늬병, 궤양병 등
- **바이러스병**: 모자이크병, 잎말림병 등

### 충해 (Pest)
- **해충**: 진딧물, 총채벌레, 응애 등
- **선충**: 뿌리혹선충 등

### 생리장해 (Physiological Disorder)
- **영양 결핍**: 질소, 인, 칼륨 등 영양소 부족
- **과다 공급**: 비료 과다로 인한 장해
- **환경 장해**: 일소, 동해, 고온 장해 등

## 기술 구조

### 1. 객체 탐지 (Object Detection)

#### YOLO (You Only Look Once)
- **실시간 탐지**: 빠른 처리 속도
- **다중 객체 탐지**: 한 이미지에서 여러 병충해 동시 탐지
- **바운딩 박스**: 병충해 위치 표시

#### YOLO 모델 버전
- **YOLOv5**: 경량화 및 고속 처리
- **YOLOv8**: 최신 버전, 높은 정확도
- **커스텀 모델**: 작물별 특화 모델

#### 탐지 과정
1. **이미지 입력**: 카메라 또는 업로드 이미지
2. **전처리**: 이미지 크기 조절, 정규화
3. **모델 추론**: YOLO 모델 실행
4. **후처리**: 탐지 결과 필터링 및 정렬
5. **결과 출력**: 병충해 종류, 위치, 신뢰도

### 2. 세그멘테이션 (Segmentation)

#### 의미 분할 (Semantic Segmentation)
- **픽셀 단위 분류**: 각 픽셀을 병충해 또는 정상으로 분류
- **병반 영역 정확히 구분**: 병반의 정확한 형태 및 크기 측정

#### 인스턴스 분할 (Instance Segmentation)
- **개별 객체 구분**: 각 병반을 개별 객체로 구분
- **병반 개수 측정**: 병반 개수 및 크기 측정

#### 모델 구조
- **U-Net**: 의료 이미지 분할에 널리 사용
- **DeepLab**: Atrous Convolution 활용
- **Mask R-CNN**: 객체 탐지 + 인스턴스 분할 통합

### 3. 분류 (Classification)

#### 병충해 분류
- **다중 분류**: 여러 병충해 종류 중 하나 선택
- **이진 분류**: 병충해 유무만 판별
- **계층적 분류**: 대분류 → 소분류

#### 모델 구조
- **CNN 기반**: ResNet, EfficientNet 등
- **전이 학습**: 사전 학습된 모델 활용
- **앙상블**: 여러 모델 결합

## 탐지 프로세스

### 1. 이미지 수집
- **자동 촬영**: 주기적 자동 촬영 (1일 1회 ~ 1시간 1회)
- **수동 업로드**: 사용자가 직접 이미지 업로드
- **실시간 스트리밍**: 실시간 카메라 스트림

### 2. 전처리
- **이미지 크기 조절**: 모델 입력 크기에 맞춤
- **색상 보정**: 조명 변화 보정
- **노이즈 제거**: 이미지 품질 향상

### 3. AI 모델 실행
- **객체 탐지**: YOLO 모델로 병충해 위치 탐지
- **세그멘테이션**: 병반 영역 정확히 구분
- **분류**: 병충해 종류 분류

### 4. 후처리
- **신뢰도 필터링**: 낮은 신뢰도 결과 제거
- **중복 제거**: 중복 탐지 결과 제거
- **결과 통합**: 여러 모델 결과 통합

### 5. 결과 출력
- **병충해 종류**: 탐지된 병충해 종류
- **위치 정보**: 병충해 위치 (바운딩 박스 또는 마스크)
- **심각도**: 병충해 심각도 (경미/중간/심각)
- **신뢰도**: 탐지 신뢰도 (0~100%)

## 활용 사례

### 1. 조기 발견
- **자동 모니터링**: 주기적 자동 탐지로 조기 발견
- **알람 발생**: 병충해 탐지 시 즉시 알람
- **확산 방지**: 초기 단계에서 확산 방지

### 2. 방제 지원
- **방제 시점 결정**: 최적 방제 시점 제안
- **방제 방법 추천**: 병충해 종류에 따른 방제 방법 추천
- **방제 효과 확인**: 방제 전후 비교 분석

### 3. 기록 관리
- **발생 이력**: 병충해 발생 이력 기록
- **통계 분석**: 발생 빈도, 패턴 분석
- **리포트 생성**: 자동 리포트 생성

## 성능 지표

### 정확도
- **탐지율 (Recall)**: 실제 병충해 중 탐지 비율 (85% 이상)
- **정밀도 (Precision)**: 탐지 결과 중 정확한 비율 (90% 이상)
- **F1-Score**: 정밀도와 재현율의 조화평균 (87% 이상)

### 처리 속도
- **이미지 분석**: 1~3초 내 분석 완료
- **실시간 처리**: 실시간 스트리밍 처리 가능

### 탐지 한계
- **초기 단계**: 매우 초기 단계 병충해는 탐지 어려움
- **유사 증상**: 유사한 증상 구분 어려움
- **환경 조건**: 조명, 각도 등 환경 조건에 영향

## 모델 개선

### 데이터셋 확대
- **다양한 환경**: 다양한 환경 조건 이미지 수집
- **다양한 작물**: 다양한 작물 종류 이미지 수집
- **다양한 병충해**: 다양한 병충해 종류 이미지 수집

### 모델 최적화
- **하이퍼파라미터 튜닝**: 최적 하이퍼파라미터 탐색
- **앙상블**: 여러 모델 결합
- **전이 학습**: 사전 학습된 모델 활용

### 지속적 학습
- **증분 학습**: 새로운 데이터로 지속적 학습
- **피드백 반영**: 사용자 피드백 반영
- **성능 모니터링**: 정기적 성능 평가

## 관련 문서

- [AI 작물 분석](./ai-crop-analysis.mdx)
- [방제 로봇](../robots/spraying-robots.mdx)
- [알람 시스템](../ui/alarms.mdx)

