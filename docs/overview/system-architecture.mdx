# 시스템 아키텍처

하모니 스마트팜 솔루션은 계층형 아키텍처로 구성되어 있으며, 각 계층은 독립적으로 동작하면서도 유기적으로 연결됩니다.

## 아키텍처 개요

```
┌─────────────────────────────────────────────────┐
│           UI & Dashboard Layer                  │
│  (React 기반 웹 대시보드, 모바일 앱)              │
│  + Data Mart / OPEN API 신청 UI                  │
└─────────────────────────────────────────────────┘
                      ↕
┌─────────────────────────────────────────────────┐
│        Control & Automation Layer               │
│  (자동화 규칙 실행, 액추에이터 제어)              │
└─────────────────────────────────────────────────┘
                      ↕
┌─────────────────────────────────────────────────┐
│           AI Analysis Engine                    │
│  (이미지 분석, 질병 탐지, 예측 모델)              │
│  + 분석 서비스 (Data Mart 연동)                  │
└─────────────────────────────────────────────────┘
                      ↕
┌─────────────────────────────────────────────────┐
│        Data Processing Layer                    │
│  (데이터 수집, 저장, 전처리, 집계)                │
│  + Data Mart (데이터셋 관리)                     │
└─────────────────────────────────────────────────┘
                      ↕
┌─────────────────────────────────────────────────┐
│          IoT Sensor Layer                       │
│  (환경센터: 온도, 습도, 토양수분, 양액,          │
│   풍향/풍속, 감우, 일사량 / 영상장비)             │
└─────────────────────────────────────────────────┘
                      ↕
┌─────────────────────────────────────────────────┐
│        OPEN API / 외부 연동                      │
│  (스마트팜코리아 OPEN API, 데이터셋 제공)         │
└─────────────────────────────────────────────────┘
```

## 계층별 상세 설명

### 1. IoT Sensor Layer (환경센터 + 영상장비)
- **환경센터**: 온도, 습도, 토양수분, 양액(EC/pH), 풍향/풍속, 감우, 일사량 등
- **영상장비**: CCTV, 웹카메라 등 작물 상태 관찰·AI 진단용 이미지 소스
- **표준 준수**: 스마트팜코리아 표준 센서 구성요소 준수

### 2. Data Processing Layer
- 센서 데이터 수집 및 전송
- 데이터베이스 저장 및 관리
- 실시간 스트리밍 처리
- 데이터 전처리 및 집계
- **Data Mart**: 데이터셋 관리 및 제공 (스마트팜코리아 연동)

### 3. AI 분석 엔진
- 컴퓨터 비전 기반 작물 분석
- 딥러닝 기반 질병 탐지
- 예측 모델을 통한 최적화 제안
- 시계열 데이터 분석
- **분석 서비스**: Data Mart 연동 분석 파이프라인

### 4. 자동화 제어 시스템 (시설별 제어 및 통합제어 장비)
- Rule Builder 기반 자동화 규칙 실행
- 액추에이터 제어 (관수모터, 양액기, 환기·난방·에너지절감 설비)
- 로봇 시스템 연동
- 예외 상황 처리

### 5. UI & Dashboard (최적 생육환경 정보관리시스템)
- 실시간 모니터링 대시보드
- 데이터 시각화
- 제어 인터페이스
- 알람 및 알림 시스템
- **Data Mart / OPEN API**: 데이터셋 다운로드 및 API 신청 UI

## 데이터 흐름

1. **센서 데이터 수집** (환경센터/영상장비) → Gateway → Cloud
2. **데이터 저장** → Time-series DB → Data Mart
3. **AI 분석** → 분석 결과 생성 (분석 서비스)
4. **규칙 평가** → 자동화 규칙 실행
5. **제어 명령** → 액추에이터/로봇 (시설별 제어 장비)
6. **시각화** → Dashboard 업데이트 (최적 생육환경 정보관리시스템)
7. **데이터 제공** → OPEN API / 데이터셋 다운로드

## 관련 문서

- [데이터 흐름 상세](../sensors/data-flow.mdx)
- [AI 분석 엔진](../ai-automation/ai-crop-analysis.mdx)
- [제어 시스템](../control-system/environment-control.mdx)

